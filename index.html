<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>World Explorer 3D - Free</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- MAPLIBRE (100% FREE) -->
<link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet">
<script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>

<style>
body{
    margin:0;
    font-family:Segoe UI,Arial;
    background:#f4f6fa;
}
header{
    background:linear-gradient(135deg,#263238,#455a64);
    color:white;
    text-align:center;
    padding:24px;
}
section{
    max-width:1200px;
    margin:25px auto;
    padding:0 15px;
}
#map{
    height:480px;
    border-radius:14px;
}
#info{
    background:white;
    padding:20px;
    border-radius:14px;
    box-shadow:0 4px 10px rgba(0,0,0,.12);
}
button{
    width:100%;
    padding:12px;
    background:#455a64;
    color:white;
    border:none;
    border-radius:8px;
    font-weight:bold;
    margin-top:12px;
}
.cards{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:15px;
    margin-top:20px;
}
.card{
    background:white;
    padding:15px;
    border-radius:12px;
    text-align:center;
    box-shadow:0 3px 8px rgba(0,0,0,.1);
}
footer{
    background:#263238;
    color:white;
    text-align:center;
    padding:20px;
}
</style>
</head>

<body>

<header>
<h1>ğŸŒ World Explorer 3D</h1>
<p>Explora la historia y rutas reales del mundo â€” 100% libre</p>
</header>

<section>
<h2>Mapa 3D Mundial</h2>
<div id="map"></div>
</section>

<section id="info">
<h2 id="placeTitle">Selecciona un lugar</h2>
<p id="placeDesc">Haz clic sobre un punto del mapa para conocer su historia.</p>
</section>

<section>
<h2>Ruta real desde tu ubicaciÃ³n</h2>
<button onclick="calcularRuta()">ğŸ“ Calcular ruta real</button>

<div class="cards">
<div class="card">ğŸ½ï¸ GastronomÃ­a</div>
<div class="card">ğŸ¨ Hospedaje</div>
<div class="card">ğŸ›‚ Documentos</div>
<div class="card">ğŸ©º Seguro mÃ©dico</div>
<div class="card">ğŸš Transporte</div>
<div class="card">ğŸ‰ Festividades</div>
</div>
</section>

<footer>
Proyecto acadÃ©mico | OpenStreetMap + MapLibre + OSRM
</footer>

<script>
/* ================= MAPA 3D ================= */
const map = new maplibregl.Map({
    container: 'map',
    style: {
        "version": 8,
        "sources": {
            "osm": {
                "type": "raster",
                "tiles": [
                    "https://tile.openstreetmap.org/{z}/{x}/{y}.png"
                ],
                "tileSize": 256
            }
        },
        "layers": [
            {
                "id": "osm",
                "type": "raster",
                "source": "osm"
            }
        ]
    },
    center: [0,20],
    zoom: 2,
    pitch: 60,
    bearing: -20
});

map.addControl(new maplibregl.NavigationControl());

/* ================= LUGARES ================= */
const lugares = [
{
    nombre:"Cusco - PerÃº",
    coords:[-71.9675,-13.5319],
    desc:"Capital del Imperio Inca, centro espiritual y cultural."
},
{
    nombre:"Petra - Jordania",
    coords:[35.4444,30.3285],
    desc:"Ciudad nabatea tallada en roca, patrimonio de la humanidad."
},
{
    nombre:"Kioto - JapÃ³n",
    coords:[135.7681,35.0116],
    desc:"Ciudad histÃ³rica japonesa, templos y tradiciones milenarias."
}
];

let destino=null;

lugares.forEach(l=>{
    const marker=document.createElement("div");
    marker.style.width="14px";
    marker.style.height="14px";
    marker.style.background="#d32f2f";
    marker.style.borderRadius="50%";

    new maplibregl.Marker(marker)
        .setLngLat(l.coords)
        .addTo(map)
        .getElement()
        .addEventListener("click",()=>{
            document.getElementById("placeTitle").innerText=l.nombre;
            document.getElementById("placeDesc").innerText=l.desc;
            destino=l.coords;
            map.flyTo({center:l.coords,zoom:11,pitch:65});
        });
});

/* ================= RUTA REAL (OSRM) ================= */
function calcularRuta(){
    if(!destino){
        alert("Selecciona primero un destino");
        return;
    }

    navigator.geolocation.getCurrentPosition(pos=>{
        const origen=[pos.coords.longitude,pos.coords.latitude];

        fetch(`https://router.project-osrm.org/route/v1/driving/${origen.join(",")};${destino.join(",")}?overview=full&geometries=geojson`)
        .then(r=>r.json())
        .then(data=>{
            const route=data.routes[0].geometry;

            if(map.getSource("route")){
                map.getSource("route").setData({
                    type:"Feature",
                    geometry:route
                });
            }else{
                map.addSource("route",{
                    type:"geojson",
                    data:{
                        type:"Feature",
                        geometry:route
                    }
                });

                map.addLayer({
                    id:"route",
                    type:"line",
                    source:"route",
                    paint:{
                        "line-color":"#ff1744",
                        "line-width":5
                    }
                });
            }
        });
    });
}
</script>

</body>
</html>
